<?xml version="1.0" encoding="utf-8" ?>
<sqlMap
	namespace="IKaan.Was.Core.SqlMaps"
	xmlns="http://ibatis.apache.org/mapping"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" >

	<statements>
		<select id="SelectChannelOrderList" parameterClass="DataMap" resultClass="ChannelOrderModel" >
			<![CDATA[
				SELECT  ROW_NUMBER() OVER (ORDER BY AA.ID DESC)	AS RowNo
					,	AA.ID
					,	AA.CreateDate
					,	AA.CreateBy
					,	AA.CreateByName
					,	AA.UpdateDate
					,	AA.UpdateBy
					,	AA.UpdateByName
					
					,	AA.ChannelID
					,	AA.OrderDate
					,	AA.OrderNo
					,	AA.OrderSeq
					,	AA.GoodsCode
					,	AA.GoodsName
					,	AA.Option1
					,	AA.Option2
					,	AA.Orderer
					,	AA.OrdererEmail
					,	AA.OrdererMobile
					,	AA.OrdererTelNo
					,	AA.Recipient
					,	AA.RecipientMobile
					,	AA.RecipientTelNo
					,	AA.PostalCode
					,	AA.RecipientAddress
					,	AA.Description
					,	AA.OrderQty
					,	AA.SupplyPrice
					,	AA.SupplyAmt
					,	AA.SalePrice
					,	AA.SaleAmt
					,	AA.DeliveryFee
					,	AA.CouponAmt
					,	AA.DealNo
					,	AA.BrandID
					,	AA.DueDate
					,	AA.GiftName
					
					,	CC.ChannelName
					,	BB.BrandName
										
				FROM	dbo.TChannelOrder AA WITH (NOLOCK)
						LEFT JOIN
							IKBiz.dbo.TChannel CC WITH (NOLOCK)
								ON AA.ChannelID = CC.ID
						LEFT JOIN
							IKBiz.dbo.TBrand BB WITH (NOLOCK)
								ON AA.BrandID = BB.ID
				WHERE	1=1
			]]>
			<isNotEmpty property="ChannelID">
				<![CDATA[
					AND	AA.ChannelID = #ChannelID#
				]]>
			</isNotEmpty>
			<isNotEmpty property="BrandID">
				<![CDATA[
					AND	AA.BrandID = #BrandID#
				]]>
			</isNotEmpty>
			<![CDATA[
				ORDER BY RowNo
			]]>
		</select>
		<select id="SelectChannelOrder" parameterClass="DataMap" resultClass="ChannelOrderModel" >
			<![CDATA[
				SELECT  *
				FROM	dbo.TAddress AA WITH (NOLOCK)
				WHERE	AA.ID = #ID#
			]]>
		</select>
		<insert id="InsertChannelOrder" parameterClass="ChannelOrderModel" >
			<![CDATA[
				INSERT INTO dbo.TChannelOrder
				( 
					CreateDate, CreateBy, CreateByName,
					ChannelID, OrderDate, OrderNo, OrderSeq,
					GoodsCode, GoodsName, Option1, Option2, 
					Orderer, OrdererEmail, OrdererMobile, OrdererTelNo,
					Recipient, RecipientMobile, RecipientTelNo, PostalCode, RecipientAddress,
					Description,
					OrderQty, SupplyPrice, SupplyAmt, SalePrice, SaleAmt, DeliveryFee, CouponAmt,
					DealNo, BrandID, DueDate, GiftName
				)
				VALUES
				(
					GetDate(), #CreateBy#, #CreateByName#,
					#ChannelID#, #OrderDate#, #OrderNo#, #OrderSeq#,
					#GoodsCode#, #GoodsName#, #Option1#, #Option2#, 
					#Orderer#, #OrdererEmail#, #OrdererMobile#, #OrdererTelNo#,
					#Recipient#, #RecipientMobile#, #RecipientTelNo#, #PostalCode#, #RecipientAddress#,
					#Description#,
					#OrderQty#, #SupplyPrice#, #SupplyAmt#, #SalePrice#, #SaleAmt#, #DeliveryFee#, #CouponAmt#,
					#DealNo#, #BrandID#, #DueDate#, #GiftName#
				)
			]]>
			<selectKey type="post" property="ID" resultClass="Int">
				<![CDATA[
					SELECT @@IDENTITY AS ID
				]]>
			</selectKey>
		</insert>
		<update id="UpdateChannelOrder" parameterClass="ChannelOrderModel">
			<![CDATA[
				UPDATE  dbo.TAddress
				SET     UpdateDate		= GetDate()
					,	UpdateBy		= #UpdateBy#
					,	UpdateByName	= #UpdateByName#
					
					,	ChannelID		= #ChannelID#
					,	OrderDate		= #OrderDate#
					,	OrderNo			= #OrderNo#
					,	OrderSeq		= #OrderSeq#
					,	GoodsCode		= #GoodsCode#
					,	GoodsName		= #GoodsName#
					,	Option1			= #Option1#
					,	Option2			= #Option2#
					,	Orderer			= #Orderer#
					,	OrdererEmail	= #OrdererEmail#
					,	OrdererMobile	= #OrdererMobile#
					,	OrdererTelNo	= #OrdererTelNo#
					,	Recipient		= #Recipient#
					,	RecipientMobile	= #RecipientMobile#
					,	RecipientTelNo	= #RecipientTelNo#
					,	PostalCode		= #PostalCode#
					,	RecipientAddress= #RecipientAddress#
					,	Description		= #Description#
					,	OrderQty		= #OrderQty#
					,	SupplyPrice		= #SupplyPrice#
					,	SupplyAmt		= #SupplyAmt#
					,	SalePrice		= #SalePrice#
					,	SaleAmt			= #SaleAmt#
					,	DeliveryFee		= #DeliveryFee#
					,	CouponAmt		= #CouponAmt#
					,	DealNo			= #DealNo#
					,	BrandID			= #BrandID#
					,	DueDate			= #DueDate#
					,	GiftName		= #GiftName#
				WHERE	ID				= #ID#
			]]>
		</update>
		<delete id="DeleteAddress" parameterClass="DataMap">
			<![CDATA[
				DELETE FROM dbo.TChannelOrder WHERE ID = #ID#;
			]]>
		</delete>
	</statements>
</sqlMap>